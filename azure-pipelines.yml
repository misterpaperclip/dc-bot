trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

jobs:
- job: PushWBCodeBotToDocker
  steps:
  - task: NodeTool@0
    inputs:
      versionSpec: '18.17.1'
    displayName: 'Install Node.js'

  - script: |
      npm install
    displayName: 'Install NPM'

  - script: |
      echo "$(DOCKER_PASSWORD)" | docker login -u "$(DOCKER_USERNAME)" --password-stdin "$(DOCKER_REGISTRY)"
      docker build -t "$(DOCKER_REGISTRY)/$(DOCKER_IMAGE_NAME)" .
      docker push "$(DOCKER_REGISTRY)/$(DOCKER_IMAGE_NAME)"
    displayName: 'Docker Things'
    env:
      DOCKER_REGISTRY: '$(DOCKER_REGISTRY)'
      DOCKER_USERNAME: '$(DOCKER_USERNAME)'
      DOCKER_PASSWORD: '$(DOCKER_PASSWORD)'
